{"title":"Bye bye Callbacks, hello Promises in NodeJS","description":"Completely get rid of callbacks in NodeJS and replace them with the great Promises.","date":"25 Jan 2021 12:00 AM","cover_image":"media/promisify-callbacks-in-nodejs-promises-everywhere.jpg","body":"<p><img src=\"\" alt=\"\" class=\"feature-image\" style=\"display: none;\"></p><div class=\"picture-container\">\n  <figure style=\"width: 100%;--padding-top: 55.58333333333333%;\">\n    <picture>\n      <source type=\"image/jpg\" media=\"(min-width: 501px)\" data-srcset=\"../media/promisify-callbacks-in-nodejs-promises-everywhere/large.jpg\">\n      <source type=\"image/jpg\" media=\"(max-width: 500px)\" data-srcset=\"../media/promisify-callbacks-in-nodejs-promises-everywhere/small.jpg\">\n      <img alt=\"Placeholder\" data-src=\"../media/promisify-callbacks-in-nodejs-promises-everywhere/large.jpg\" class=\"lazyload blog-img\">\n    </picture>\n  </figure>\n  </div><p></p>\n<p>These is gonna be a meme-tastic blog post. Strap yourself in.</p>\n<p>So, I guess you read the [super]clickbaity title, and couldn't resist it, huh? Well, no worries, I <strong>promise</strong> you <img class=\"emoji\" draggable=\"false\" alt=\"😁\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f601.svg\"> this is gonna be good.</p>\n<h1 id=\"History-lesson\"><a class=\"heading-link\" href=\"/blog/promisify-callbacks-in-nodejs#History-lesson\">#</a>History lesson <img class=\"emoji\" draggable=\"false\" alt=\"😴\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f634.svg\"></h1>\n<p>NodeJS initially shipped with callbacks for its amazing asynchronous model which made it an overnight star in the first place. And callbacks were cool. You could read a huge file, and write the code in such a way to simply wait for the response to come out. This applied to database reads, XHR calls(ajax). This model was groundbreaking when it came out.</p>\n<p>Callbacks follow this pattern <img class=\"emoji\" draggable=\"false\" alt=\"👇\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f447.svg\"></p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #61AFEF\">callback</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">param1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">param2</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">param3</span><span style=\"color: #ABB2BF\">, (</span><span style=\"color: #E06C75\">error</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">)) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #7F848E\">// Do something</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Note, there can be any number of parameters before the actual callback as the last parameter, and the callback doesn't have to have only <code>data</code> either, it can be any number of parameters, or not have any, other than the <code>error</code>.</p>\n<p>But there's a funny thing that happens when you dive super deep into something. <strong>YoU fInD oUt ItS fLaWs.</strong> <img class=\"emoji\" draggable=\"false\" alt=\"👇\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f447.svg\"></p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #E5C07B\">fs</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">readdir</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">source</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">files</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">'Error finding files: '</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  } </span><span style=\"color: #C678DD\">else</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">files</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">forEach</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">filename</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">fileIndex</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">filename</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #61AFEF\">gm</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">source</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">filename</span><span style=\"color: #ABB2BF\">).</span><span style=\"color: #61AFEF\">size</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">values</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">'Error identifying file size: '</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        } </span><span style=\"color: #C678DD\">else</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">filename</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">' : '</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">values</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #E06C75\">aspect</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">values</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">/</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">values</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #E5C07B\">widths</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">forEach</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">widthIndex</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">              </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Math</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #56B6C2\">round</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">/</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">aspect</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">              </span><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">'resizing '</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">filename</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">'to '</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">'x'</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">              </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">resize</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">).</span><span style=\"color: #61AFEF\">write</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">dest</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">'w'</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">'_'</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">filename</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">'Error writing file: '</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">              });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            }.</span><span style=\"color: #61AFEF\">bind</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          );</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">});</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Oh boy, my eyes bleed <img class=\"emoji\" draggable=\"false\" alt=\"🙈\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f648.svg\"></p>\n<p>I guess this twitter meme was on point <img class=\"emoji\" draggable=\"false\" alt=\"👇\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f447.svg\"></p>\n<p><img src=\"\" alt=\"\" class=\"feature-image\" style=\"display: none;\"></p><div class=\"picture-container\">\n  <div class=\"gif-vid-container\">\n    <video autoplay=\"\" loop=\"\" muted=\"\" playsinline=\"\">\n      <source src=\"../media/promisify-callbacks-in-nodejs-goku-meme/vidgif.mp4\" type=\"video/mp4\">\n      Your browser doesn't support HTML5 video playback. <a href=\"../media/promisify-callbacks-in-nodejs-goku-meme.gif\" target=\"_blank\" rel=\"noopener\">See the gif here</a>\n    </video>\n  </div>\n  </div><p></p>\n<h1 id=\"Enter-promises\"><a class=\"heading-link\" href=\"/blog/promisify-callbacks-in-nodejs#Enter-promises\">#</a>Enter promises</h1>\n<p>Promises radicalized the whole scene. They made our code even cleaner. They follow a much simpler structure. No need for all that indentation inside indentation inside indentation. Max to max 1 level of indentation is needed</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">finalData</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">fetch</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">'https://api.example/com'</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  .</span><span style=\"color: #61AFEF\">then</span><span style=\"color: #ABB2BF\">((</span><span style=\"color: #E06C75\">req</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">=&gt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">req</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">json</span><span style=\"color: #ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  .</span><span style=\"color: #61AFEF\">then</span><span style=\"color: #ABB2BF\">((</span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">=&gt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">cleanUpData</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  .</span><span style=\"color: #61AFEF\">then</span><span style=\"color: #ABB2BF\">((</span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">=&gt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">doEpicShit</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">));</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Using the <code>.then</code> pattern made life super easy.</p>\n<p>And then came <mark>async/await</mark>. Above code became even simpler:</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">req</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">await</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">fetch</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">'https://api.example.com'</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">data</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">await</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">req</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">json</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">finalData</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">cleanUpData</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #61AFEF\">doEpicShit</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">finalData</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span></code></pre>\n<p>So flat <img class=\"emoji\" draggable=\"false\" alt=\"😇\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f607.svg\"></p>\n<h1 id=\"Callback-to-Promise\"><a class=\"heading-link\" href=\"/blog/promisify-callbacks-in-nodejs#Callback-to-Promise\">#</a>Callback to Promise</h1>\n<p>Converting callbacks to promises in NodeJS is very simple. If you're using <code>fs.readdir</code>.</p>\n<p>We'll redefine it:</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">readdirPromise</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">folderPath</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">=&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Promise</span><span style=\"color: #ABB2BF\">((</span><span style=\"color: #E06C75\">resolve</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">reject</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">=&gt;</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">return</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">fs</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">readdir</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">folderPath</span><span style=\"color: #ABB2BF\">, (</span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">filenames</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">=&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">!=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">null</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">?</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">reject</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">err</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">:</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">resolve</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">filenames</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    );</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  });</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Just do it for every single function <img class=\"emoji\" draggable=\"false\" alt=\"😉\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f609.svg\"></p>\n<p><strong>NOTE</strong>: The above part was a joke. You don't need to redefine every single callback function like that.</p>\n<h2 id=\"Serious-way...\"><a class=\"heading-link\" href=\"/blog/promisify-callbacks-in-nodejs#Serious-way...\">#</a>Serious way...</h2>\n<p>Since Node 8, there's been a built-in helper function into Node, called <code>promisify</code>. It's the easiest way to promisify your callbacks. Check it out <img class=\"emoji\" draggable=\"false\" alt=\"👇\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f447.svg\"></p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> { </span><span style=\"color: #E5C07B\">promisify</span><span style=\"color: #ABB2BF\"> } </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">require</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">'util'</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">callbackP</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">promisify</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">callback</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">await</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">callbackP</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"></span></code></pre>\n<p>That's it. Just pass your callback to <code>promisify</code>, and it will magically be <code>.then</code>able and <code>await</code>able.</p>\n<h1 id=\"About-filesystem-API...\"><a class=\"heading-link\" href=\"/blog/promisify-callbacks-in-nodejs#About-filesystem-API...\">#</a>About filesystem API...</h1>\n<p>Most of the time, you'll end up needing promisification for the <code>fs</code> API in NodeJS. But there's a good news. <code>fs</code> <strong>already ships with promise based version of its functions</strong>.</p>\n<p>Check out my article to know this uncanny art: <a href=\"https://puruvj.dev/blog/fs-promises\" target=\"_blank\" rel=\"noopener\">Simple code with fs.promises and async await</a>.</p>\n<p>Hope you got something good out of it <img class=\"emoji\" draggable=\"false\" alt=\"😇\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f607.svg\">.</p>\n<p>Thank you for reading.</p>\n","id":"promisify-callbacks-in-nodejs","reading_time":4.035,"toc":[{"indent":0,"id":"","title":"History lesson 😴","length":17},{"indent":0,"id":"","title":"Enter promises","length":14},{"indent":0,"id":"","title":"Callback to Promise","length":19},{"indent":1,"id":"","title":"Serious way...","length":14},{"indent":0,"id":"","title":"About filesystem API...","length":23}]}