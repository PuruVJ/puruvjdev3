{"title":"Split Array into `n` number of chunks","description":"Split an array into `n` number of multiple arrays with JavaScript","date":"27 sep, 2020 10:45 AM","cover_image":"../media/blog-social-intro.png","body":"<p>Recently, while making my blog, I ran into a problem. I was using headless chrome to take snapshot of the URLs provided on the <mark>Works</mark> page, and it was turning out to be quite slow, even on Cloud Servers, which have top-notch internet and processing speed.</p>\n<p>I was passing it a URL at a time, it would go to it, take a snapshot, then move to the next URL, and so on. It was a very linear process.</p>\n<p>But those servers being so powerful, they could've snapshot 5 pages at once at the speed it takes for 1 page. So I decided to split the work up in chunks. I broke the urls up in chunks of 5. Chrome would snapshot those 5 simultaneously, and when it was done with all, it would move on to the next 5, and so on. The times reduced to a <code>third</code> of the time.</p>\n<p>Consider this array <code>list</code>. For our purposes, let's just deal simply with numbers rather than URLs.</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">list</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">3</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">4</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">5</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">6</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">7</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">8</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">9</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">10</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">11</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">12</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Now I want to split it into chunks of 5, like this,</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">splitList</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  [</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">3</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">4</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">5</span><span style=\"color: #ABB2BF\">],</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  [</span><span style=\"color: #D19A66\">6</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">7</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">8</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">9</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">10</span><span style=\"color: #ABB2BF\">],</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  [</span><span style=\"color: #D19A66\">11</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">12</span><span style=\"color: #ABB2BF\">],</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Or chunks of 4:</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">SplitList</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  [</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">3</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">4</span><span style=\"color: #ABB2BF\">],</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  [</span><span style=\"color: #D19A66\">5</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">6</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">7</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">8</span><span style=\"color: #ABB2BF\">],</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  [</span><span style=\"color: #D19A66\">9</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">10</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">11</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">12</span><span style=\"color: #ABB2BF\">],</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"></span></code></pre>\n<p>You get the idea.</p>\n<h1 id=\"Code\"><a class=\"heading-link\" href=\"/blog/split-array-chunks#Code\">#</a>Code</h1>\n<p>The code for splitting an array in its simplest form would be:</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #7F848E\">/**</span></span>\n<span class=\"line\"><span style=\"color: #7F848E\"> * </span><span style=\"color: #C678DD\">@param</span><span style=\"color: #7F848E\"> </span><span style=\"color: #E5C07B\">{Array}</span><span style=\"color: #7F848E\"> </span><span style=\"color: #E06C75\">arr</span><span style=\"color: #7F848E\"> The array to be broken into chunks</span></span>\n<span class=\"line\"><span style=\"color: #7F848E\"> * </span><span style=\"color: #C678DD\">@param</span><span style=\"color: #7F848E\"> </span><span style=\"color: #E5C07B\">{number}</span><span style=\"color: #7F848E\"> </span><span style=\"color: #E06C75\">n</span><span style=\"color: #7F848E\"> The number of items in each chunk</span></span>\n<span class=\"line\"><span style=\"color: #7F848E\"> */</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">chunks</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">arr</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">n</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">items</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [...</span><span style=\"color: #E06C75\">arr</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #C678DD\">return</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Array</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Math</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #56B6C2\">ceil</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">items</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">length</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">/</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">n</span><span style=\"color: #ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">fill</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">map</span><span style=\"color: #ABB2BF\">(() </span><span style=\"color: #C678DD\">=&gt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">items</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">splice</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">n</span><span style=\"color: #ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span></code></pre>\n<p>Let's break it down piece by piece:</p>\n<ul>\n<li>\n<p>We're returning an <code>Array</code> with the number of items defined by <code>Math.ceil(items.length / n)</code>. if <code>items.length</code> is 12, and <code>n</code> is 5, we would get the devision as 2.4 . More than 2, less than 3. 2 items(11, 12) will be leftover, and will need to be accomodated in 3rd array, so <code>Math.ceil</code> the division.</p>\n</li>\n<li>\n<p><code>.fill()</code> simply fills the array up with <code>undefined</code>. This is to get an array with the required size, and we can modify those values later. The example above would return <code>[undefined, undefined, undefined]</code>.</p>\n</li>\n<li>\n<p><code>.map()</code> We're traversing over every value in the array of <code>undefined</code> and replacing it with a chunk of the <code>items</code> array. <code>splice</code> removes a chunk from the given array and returns as the value for the <code>.map</code></p>\n</li>\n<li>\n<p>Lastly, notice we're cloning <code>arr</code> into <code>items</code>. This is required to not mutate the original value.</p>\n</li>\n</ul>\n<h2 id=\"Explanation\"><a class=\"heading-link\" href=\"/blog/split-array-chunks#Explanation\">#</a>Explanation</h2>\n<p>Let's see how <code>splice</code> works</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">arr</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">3</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">4</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">5</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">6</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">7</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">8</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">9</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">spliced</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">arr</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">splice</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">3</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E\">// let's print both the original array and spliced array</span></span>\n<span class=\"line\"><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">spliced</span><span style=\"color: #ABB2BF\">); </span><span style=\"color: #7F848E\">// Output: [1, 2, 3]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">arr</span><span style=\"color: #ABB2BF\">); </span><span style=\"color: #7F848E\">// [4, 5, 6, 7, 8, 9]</span></span>\n<span class=\"line\"></span></code></pre>\n<p><code>splice</code> mutated the original array.</p>\n<p>That's what would happen in the <code>chunks</code> function.</p>\n<pre class=\"shiki\" style=\"background-color: #282c34\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">arr</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">3</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">4</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">5</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">6</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">7</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">8</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">9</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">10</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">11</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">12</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">chunked</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">chunks</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">arr</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">5</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">arr</span><span style=\"color: #ABB2BF\">); </span><span style=\"color: #7F848E\">// Output: []</span></span>\n<span class=\"line\"></span></code></pre>\n<p><code>chunks</code> would remove all the values from the original array. However due to cloning the passed array and working on it, we avoid this problem.</p>\n<h1 id=\"Conclusion\"><a class=\"heading-link\" href=\"/blog/split-array-chunks#Conclusion\">#</a>Conclusion</h1>\n<p>Go chunk it up <img class=\"emoji\" draggable=\"false\" alt=\"😉\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f609.svg\"> <img class=\"emoji\" draggable=\"false\" alt=\"😜\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f61c.svg\"> <img class=\"emoji\" draggable=\"false\" alt=\"🤣\" src=\"https://twemoji.maxcdn.com/v/13.1.0/svg/1f923.svg\"></p>\n","id":"split-array-chunks","reading_time":3.02,"toc":[{"indent":0,"id":"","title":"Code","length":4},{"indent":1,"id":"","title":"Explanation","length":11},{"indent":0,"id":"","title":"Conclusion","length":10}]}